<Window x:Class="My_book_10.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:local="clr-namespace:My_book_10"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        FontFamily="{StaticResource Comfortaa}"
        Foreground="{DynamicResource ForeGround}"
        mc:Ignorable="d"
        KeyDown="Window_KeyDown"
        ResizeMode="CanResize"
        MaxHeight="{Binding Source={x:Static SystemParameters.WorkArea}, Path=Height}"
        Title="MainWindow" Height="450" Width="800" Background="Transparent" AllowsTransparency="True" WindowStyle="None" Icon="/Resources/icon.png" MouseLeftButtonDown="Window_MouseLeftButtonDown" Loaded="MainWindow_Loaded">

    <Window.RenderTransform>
        <ScaleTransform ScaleX="1" ScaleY="1"/>
    </Window.RenderTransform>

    <Window.Resources>
        <ResourceDictionary>
            <Storyboard x:Key="EnableFocusMode">
                <DoubleAnimation Storyboard.TargetName="BlurEffect"
                         Storyboard.TargetProperty="Radius"
                         From="0" To="10" Duration="0:0:0.5" />
            </Storyboard>

            <Storyboard x:Key="DisableFocusMode">
                <DoubleAnimation Storyboard.TargetName="BlurEffect"
                         Storyboard.TargetProperty="Radius"
                         From="10" To="0" Duration="0:0:0.5" />
            </Storyboard>
            <Style TargetType="ToggleButton">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type ToggleButton}">
                            <Grid>
                                <Border CornerRadius="9" Background="{DynamicResource OptionalBack2}">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                <!-- Полоска, которая появляется при IsChecked = True -->
                                <Border x:Name="CheckedBorder" Background="{DynamicResource BrandColor}" Height="2" Margin="3" HorizontalAlignment="Stretch" VerticalAlignment="Bottom" CornerRadius="3,3,0,0" Visibility="Collapsed"/>
                            </Grid>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="{DynamicResource OptionalBack2}"/>
                                </Trigger>
                                <Trigger Property="IsPressed" Value="True">
                                    <Setter Property="Background" Value="{DynamicResource OptionalBack}"/>
                                </Trigger>
                                <Trigger Property="IsChecked" Value="True">
                                    <Setter Property="Background" Value="{DynamicResource BrandColor}"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            <Style x:Key="1" TargetType="Button">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type ToggleButton}">
                            <Border CornerRadius="9" Background="{DynamicResource OptionalBack2}">
                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="{DynamicResource OptionalBack2}"/>
                                </Trigger>
                                <Trigger Property="IsPressed" Value="True">
                                    <Setter Property="Background" Value="{DynamicResource OptionalBack}"/>
                                </Trigger>
                                <Trigger Property="IsChecked" Value="True">
                                    <Setter Property="Background" Value="{DynamicResource BrandColor}"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </ResourceDictionary>
    </Window.Resources>
    <Grid>
        <Border Background="{DynamicResource BackGround}" CornerRadius="15">
            <Grid x:Name="MainContent">
                <Grid.RowDefinitions>
                    <RowDefinition Height="35"/>
                    <RowDefinition/>
                </Grid.RowDefinitions>
                <Grid Grid.Row="0">
                    <Border Background="{DynamicResource OptionalColor}" CornerRadius="15" HorizontalAlignment="Right" Margin="0,0,5,0">
                        <StackPanel Orientation="Horizontal">
                            <Button x:Name="Minimize" Content="-" Width="30" Style="{DynamicResource ButtonFlat}" Click="Minimize_Click"/>
                            <Button x:Name="FullScren" Content="▢" Width="30" Style="{DynamicResource ButtonFlat}" Click="FullScrin_Click"/>
                            <Button x:Name="Close" Content="✕" Width="30" Style="{DynamicResource ButtonFlat}" Click="Close_Click"/>
                        </StackPanel>
                    </Border>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="My book" FontSize="20" MouseLeftButtonDown="TextBlock_MouseLeftButtonDown" Margin="15,5,5,5" VerticalAlignment="Center"/>
                        <Button x:Name="Open" Width="65" Style="{StaticResource ButtonFlat}" Margin="5" Height="20" BorderBrush="{x:Null}" Foreground="{DynamicResource ForeGround}" Click="Open_Click">
                            <TextBlock FontSize="11" TextAlignment="Center" Text="{DynamicResource items.open}"/>
                        </Button>
                        <Button x:Name="Save" Width="70" Style="{StaticResource ButtonFlat}" Margin="5" Height="20" Foreground="{DynamicResource ForeGround}" Click="Save_Click">
                            <TextBlock FontSize="11" TextAlignment="Center" Text="{DynamicResource items.save}"/>
                        </Button>
                        <Button x:Name="New" Width="60" Style="{StaticResource ButtonFlat}" Margin="5" Height="20" Foreground="{DynamicResource ForeGround}" Click="New_Click">
                            <TextBlock FontSize="11" TextAlignment="Center" Text="{DynamicResource items.new}"/>
                        </Button>
                        <Button x:Name="CloseDocument" Width="60" Style="{StaticResource ButtonFlat}" Margin="5" Height="20" Foreground="{DynamicResource ForeGround}" Click="CloseDocument_Click">
                            <TextBlock FontSize="11" TextAlignment="Center" Text="{DynamicResource items.close}"/>
                        </Button>
                        <Button x:Name="View" Width="60" Style="{StaticResource ButtonFlat}" Margin="5" Height="20" Foreground="{DynamicResource ForeGround}" Click="View_Click">
                            <TextBlock FontSize="11" TextAlignment="Center" Text="View"/>
                            <Button.ContextMenu>
                                <ContextMenu>
                                    <MenuItem Header="{DynamicResource items.view.focusmode}" Click="FocusMode"/>
                                </ContextMenu>
                            </Button.ContextMenu>
                        </Button>
                    </StackPanel>
                </Grid>
                <Border Background="{DynamicResource OptionalColor}" Grid.Row="1" Margin="5" CornerRadius="15">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition x:Name="Items" Height="50"/>
                            <RowDefinition/>
                        </Grid.RowDefinitions>
                        <Border Grid.Row="1" Background="{DynamicResource OptionalBack}" Margin="5" CornerRadius="15">
                            <RichTextBox x:Name="rtbEditor" KeyDown="rtbEditor_KeyDown" ContextMenuOpening="rtbEditor_ContextMenuOpening" SelectionChanged="rtbEditor_SelectionChanged">
                                <RichTextBox.ContextMenu>
                                    <ContextMenu>
                                        <MenuItem Header="Копировать" Click="CopyText_Click">
                                            <MenuItem.Icon>
                                                <Image Source="{DynamicResource Cm.Copy}" Width="16" Height="16"/>
                                            </MenuItem.Icon>
                                        </MenuItem>
                                        <MenuItem Header="Вставить" Click="PasteText_Click">
                                            <MenuItem.Icon>
                                                <Image Source="{DynamicResource Cm.Paste}" Width="16" Height="16"/>
                                            </MenuItem.Icon>
                                        </MenuItem>
                                        <MenuItem Header="Выделить всё" Click="SelectAllText_Click">
                                            <MenuItem.Icon>
                                                <Image Source="{DynamicResource Cm.SelectAll}" Width="16" Height="16"/>
                                            </MenuItem.Icon>
                                        </MenuItem>
                                        <Separator Style="{StaticResource MaterialDesignSeparator}"/>
                                        <MenuItem x:Name="cRemoveTable" Header="Удалить таблицу" Click="RemoveTable"/>
                                        <MenuItem x:Name="cAddCollumnTable" Header="Добавить столбец в таблицу" Click="AddCollumnTable"/>
                                        <MenuItem x:Name="cRemoveCollumnTable"  Header="Удалить столбец из таблицы" Click="RemoveCollumnTable"/>
                                        <MenuItem x:Name="cAddRowTable"  Header="Добавить строку в таблицу" Click="AddRowToTable"/>
                                        <MenuItem x:Name="cRemoveRowTable" Header="Удалить строку из таблицы" Click="RemoveRowFromTable"/>
                                    </ContextMenu>
                                </RichTextBox.ContextMenu>
                            </RichTextBox>
                        </Border>
                        <ScrollViewer Grid.Row="0" HorizontalScrollBarVisibility="Hidden" VerticalScrollBarVisibility="Disabled">
                            <Grid>
                                <Border Background="{DynamicResource OptionalBack2}" HorizontalAlignment="Left" Margin="5" CornerRadius="10">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition/>
                                            <ColumnDefinition/>
                                        </Grid.ColumnDefinitions>
                                        <Button Margin="3" Grid.Column="0" ToolTip="{DynamicResource tooltip.search}" Grid.Row="0" Style="{DynamicResource SearchButton}" Click="SearchButton_Click">
                                            <Image Source="{DynamicResource Search}"/>
                                        </Button>
                                        <Button Margin="3" Grid.Column="0" ToolTip="{DynamicResource tooltip.search}" Grid.Row="1" Style="{DynamicResource SearchButton}" Click="SearchButton_Click">
                                            <Image Source="{DynamicResource Replace}"/>
                                        </Button>
                                    </Grid>
                                </Border>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="15,0,15,0">
                                    <ComboBox x:Name="cmbFontFamily" ToolTip="{DynamicResource tooltip.font}" Text="Comfortaa" Margin="5" Width="100" SelectionChanged="cmbFontFamily_SelectionChanged"/>
                                    <ComboBox x:Name="cmbFontSize" ToolTip="{DynamicResource tooltip.fontsize}" Margin="5" Width="30" IsEditable="True" TextBoxBase.TextChanged="cmbFontSize_TextChanged"/>
                                    <Border Background="{DynamicResource OptionalBack2}" Margin="5" CornerRadius="15">
                                        <StackPanel Orientation="Horizontal">
                                            <ToggleButton Width="40" x:Name="Bold" Checked="BoldToggleButton_Checked" Style="{DynamicResource MaterialDesignFlatButton}" Unchecked="BoldToggleButton_Unchecked">
                                                <TextBlock Text="B" FontFamily="Segoe UI" FontWeight="Bold" FontSize="14" Foreground="{DynamicResource ForeGround}"/>
                                            </ToggleButton>
                                            <ToggleButton Width="42" x:Name="Underline" Checked="UnderlineToggleButton_Checked" Style="{DynamicResource MaterialDesignFlatButton}" Unchecked="UnderlineToggleButton_Unchecked">
                                                <TextBlock Text="U̲" FontFamily="Segoe UI" FontSize="14" Foreground="{DynamicResource ForeGround}"/>
                                            </ToggleButton>
                                            <ToggleButton Width="40" x:Name="Italic" Checked="ItalicToggleButton_Checked" Style="{DynamicResource MaterialDesignFlatButton}" Unchecked="ItalicToggleButton_Unchecked">
                                                <TextBlock Text="I" FontFamily="Segoe UI" FontStyle="Italic" FontSize="14" Foreground="{DynamicResource ForeGround}"/>
                                            </ToggleButton>
                                        </StackPanel>
                                    </Border>
                                    <Button Width="40" x:Name="TextColor" Margin="5" Style="{DynamicResource ColorButton}" Click="TextColor_Click">
                                        <TextBlock Text="А" FontFamily="Segoe UI" FontSize="14" Foreground="Red" TextDecorations="Underline"/>
                                    </Button>
                                    <Button Width="40" x:Name="LeftAligh" Margin="15,5,5,5" Style="{DynamicResource ColorButton}" Click="AlignLeft_Click">
                                        <Image Source="{DynamicResource Align.Left}" Margin="7"/>
                                    </Button>
                                    <Button Width="40" x:Name="CenterAligh" Margin="5" Style="{DynamicResource ColorButton}" Click="AlignCenter_Click">
                                        <Image Source="{DynamicResource Align.Center}" Margin="7"/>
                                    </Button>
                                    <Button Width="40" x:Name="RightAligh" Margin="5" Style="{DynamicResource ColorButton}" Click="AlignRight_Click">
                                        <Image Source="{DynamicResource Align.Right}" Margin="7"/>
                                    </Button>
                                    <Button Width="40" x:Name="AddImage" Margin="15,5,5,5" Style="{DynamicResource ColorButton}" Click="InsertImage_Click">
                                        <Image Source="{DynamicResource Image.Add}" Margin="7"/>
                                    </Button>
                                    <Button Width="40" x:Name="RemoveImage" Margin="5" Style="{DynamicResource ColorButton}" Click="RemoveImage_Click">
                                        <Image Source="{DynamicResource Image.Remove}" Margin="7"/>
                                    </Button>
                                    <Button Width="40" x:Name="InsertTable" Margin="15,5,5,5" Style="{DynamicResource ColorButton}" Click="InsertTable_menu">
                                        <Image Source="{DynamicResource Table.Insert}" Margin="7"/>
                                    </Button>
                                    <Button Width="40" x:Name="InsertList" Margin="15,5,5,5" Style="{DynamicResource ColorButton}" Click="InsertList_Click">
                                        <Image Source="{DynamicResource List.Insert}" Margin="7"/>
                                    </Button>
                                </StackPanel>
                            </Grid>
                        </ScrollViewer>
                        <Border x:Name="SetLineH" CornerRadius="15" Visibility="Hidden" Background="{DynamicResource OptionalColor}" VerticalAlignment="Top" HorizontalAlignment="Center" Margin="0,5,0,0" Grid.Row="1">
                            <StackPanel Orientation="Horizontal">
                                <Border Width="50" Height="20" Margin="5" CornerRadius="10" Background="{DynamicResource BackGround}">
                                    <Button x:Name="SetLineSpacing" Style="{DynamicResource ButtonFlat}" Content="0.5" Click="SetLineSpacing_Click">
                                        <Button.Tag>
                                            <sys:Double>0.5</sys:Double>
                                        </Button.Tag>
                                    </Button>
                                </Border>
                                <Border Width="50" Height="20" Margin="5" CornerRadius="10" Background="{DynamicResource BackGround}">
                                    <Button Style="{DynamicResource ButtonFlat}" Content="1" Click="SetLineSpacing_Click">
                                        <Button.Tag>
                                            <sys:Double>1</sys:Double>
                                        </Button.Tag>
                                    </Button>
                                </Border>
                                <Border Width="50" Height="20" Margin="5" CornerRadius="10" Background="{DynamicResource BackGround}">
                                    <Button Style="{DynamicResource ButtonFlat}" Content="1.15" Click="SetLineSpacing_Click">
                                        <Button.Tag>
                                            <sys:Double>1.15</sys:Double>
                                        </Button.Tag>
                                    </Button>
                                </Border>
                                <Border Width="50" Height="20" Margin="5" CornerRadius="10" Background="{DynamicResource BackGround}">
                                    <Button Style="{DynamicResource ButtonFlat}" Content="1.5" Click="SetLineSpacing_Click">
                                        <Button.Tag>
                                            <sys:Double>1.5</sys:Double>
                                        </Button.Tag>
                                    </Button>
                                </Border>
                                <Border Width="50" Height="20" Margin="5" CornerRadius="10" Background="{DynamicResource BackGround}">
                                    <Button Style="{DynamicResource ButtonFlat}" Content="2" Click="SetLineSpacing_Click">
                                        <Button.Tag>
                                            <sys:Double>2</sys:Double>
                                        </Button.Tag>
                                    </Button>
                                </Border>
                            </StackPanel>
                        </Border>
                        <Border x:Name="Table" CornerRadius="15" Visibility="Hidden" Background="{DynamicResource OptionalColor}" VerticalAlignment="Top" HorizontalAlignment="Right" Margin="5" Grid.Row="1">
                            <StackPanel Orientation="Vertical">
                                <StackPanel Orientation="Horizontal" Margin="10,10,10,3">
                                    <TextBlock Text="{DynamicResource rich.table}" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                    <local:NumericDropDown x:Name="RowsNDD"/>
                                    <TextBlock Text="x" VerticalAlignment="Center" Margin="5,0,5,0"/>
                                    <local:NumericDropDown x:Name="ColumnsNDD"/>
                                </StackPanel>
                                <Button Margin="5,0,5,5" Style="{StaticResource CornerButton}" Height="20" Click="InsertTable_apply">
                                    <TextBlock Text="{DynamicResource rich.table.apply}"/>
                                </Button>
                            </StackPanel>
                        </Border>
                        <Border x:Name="Search" CornerRadius="15" Visibility="Hidden" Background="{DynamicResource OptionalColor}" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="5" Grid.Row="1">
                            <StackPanel Orientation="Horizontal" Margin="5">
                                <TextBox x:Name="SearchBox" KeyDown="SearchBox_KeyDown" Width="200" Margin="3"/>
                                <Button x:Name="SearchBack" Click="SearchBack_Click" Width="25" Margin="3" Style="{DynamicResource SearchButton}">
                                    <Image Source="{DynamicResource Search.Back}" Margin="3"/>
                                </Button>
                                <Button x:Name="SearchNext" Click="SearchNext_Click" Width="25" Margin="3" Style="{DynamicResource SearchButton}">
                                    <Image Source="{DynamicResource Search.Next}" Margin="3"/>
                                </Button>
                            </StackPanel>
                        </Border>
                        <Border x:Name="ListParameter" CornerRadius="15" Visibility="Hidden" Background="{DynamicResource OptionalColor}" VerticalAlignment="Top" HorizontalAlignment="Right" Margin="5" Grid.Row="1">
                            <StackPanel Orientation="Vertical">
                                <StackPanel Orientation="Horizontal" Margin="5">
                                    <Button Style="{DynamicResource ColorButton}" Margin="5" Click="CreateListParameter">
                                        <Button.Tag>
                                            <sys:Boolean>true</sys:Boolean>
                                        </Button.Tag>
                                        <TextBlock Text="Нумерованый список" Margin="5"/>
                                    </Button>
                                    <Button Style="{DynamicResource ColorButton}" Margin="5" Click="CreateListParameter">
                                        <Button.Tag>
                                            <sys:Boolean>false</sys:Boolean>
                                        </Button.Tag>
                                        <TextBlock Text="Маркированый список" Margin="5"/>
                                    </Button>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                        <Border x:Name="Colors" Visibility="Hidden" CornerRadius="15" Background="{DynamicResource OptionalColor}" VerticalAlignment="Top" HorizontalAlignment="Center" Margin="0,5,0,0" Grid.Row="1" >
                            <StackPanel Orientation="Vertical">
                                <Button x:Name="StandartColor" Click="StandartColor_Click" Width="20" Height="20" Style="{DynamicResource ColorButton}" Background="{DynamicResource ForeGround}" Margin="5">
                                </Button>
                                <TextBlock Margin="5" TextAlignment="Center" Text="{DynamicResource rich.color}"/>
                                <Border Margin="5">
                                    <StackPanel Orientation="Horizontal">
                                        <StackPanel Orientation="Vertical">
                                            <Button x:Name="White" Click="ChangeColor" Width="20" Height="20" Style="{DynamicResource ColorButton}" Margin="5" Background="White">
                                            </Button>
                                            <Button x:Name="FFF3F3F3" Click="ChangeColorHEX" Width="20" Height="20" Style="{DynamicResource ColorButton}" Margin="5" Background="#FFF3F3F3">
                                            </Button>
                                            <Button x:Name="FFD2D2D2" Click="ChangeColorHEX" Width="20" Height="20" Style="{DynamicResource ColorButton}" Margin="5" Background="#FFD2D2D2">
                                            </Button>
                                            <Button x:Name="FFB9B9B9" Click="ChangeColorHEX" Width="20" Height="20" Style="{DynamicResource ColorButton}" Margin="5" Background="#FFB9B9B9">
                                            </Button>
                                        </StackPanel>
                                        <StackPanel Orientation="Vertical">
                                            <Button x:Name="Black" Click="ChangeColor" Width="20" Height="20" Style="{DynamicResource ColorButton}" Margin="5" Background="Black">
                                            </Button>
                                            <Button x:Name="FF212121" Click="ChangeColorHEX" Width="20" Height="20" Style="{DynamicResource ColorButton}" Margin="5" Background="#FF212121">
                                            </Button>
                                            <Button x:Name="FF424242" Click="ChangeColorHEX" Width="20" Height="20" Style="{DynamicResource ColorButton}" Margin="5" Background="#FF424242">
                                            </Button>
                                            <Button x:Name="FF717171" Click="ChangeColorHEX" Width="20" Height="20" Style="{DynamicResource ColorButton}" Margin="5" Background="#FF717171">
                                            </Button>
                                        </StackPanel>
                                        <StackPanel Orientation="Vertical">
                                            <Button x:Name="Yellow" Click="ChangeColor" Width="20" Height="20" Style="{DynamicResource ColorButton}" Margin="5" Background="Yellow">
                                            </Button>
                                            <Button x:Name="FFFFFFB4" Click="ChangeColorHEX" Width="20" Height="20" Style="{DynamicResource ColorButton}" Margin="5" Background="#FFFFFFB4">
                                            </Button>
                                            <Button x:Name="FFEDED7B" Click="ChangeColorHEX" Width="20" Height="20" Style="{DynamicResource ColorButton}" Margin="5" Background="#FFEDED7B">
                                            </Button>
                                            <Button x:Name="FFCCCC45" Click="ChangeColorHEX" Width="20" Height="20" Style="{DynamicResource ColorButton}" Margin="5" Background="#FFCCCC45">
                                            </Button>
                                        </StackPanel>
                                        <StackPanel Orientation="Vertical">
                                            <Button x:Name="Red" Click="ChangeColor" Width="20" Height="20" Style="{DynamicResource ColorButton}" Margin="5" Background="Red">
                                            </Button>
                                            <Button x:Name="FFE41C1C" Click="ChangeColorHEX" Width="20" Height="20" Style="{DynamicResource ColorButton}" Margin="5" Background="#FFE41C1C">
                                            </Button>
                                            <Button x:Name="FFEC4949" Click="ChangeColorHEX" Width="20" Height="20" Style="{DynamicResource ColorButton}" Margin="5" Background="#FFEC4949">
                                            </Button>
                                            <Button x:Name="FFAB4141" Click="ChangeColorHEX" Width="20" Height="20" Style="{DynamicResource ColorButton}" Margin="5" Background="#FFAB4141">
                                            </Button>
                                        </StackPanel>
                                        <StackPanel Orientation="Vertical">
                                            <Button x:Name="Blue" Click="ChangeColor" Width="20" Height="20" Style="{DynamicResource ColorButton}" Margin="5" Background="Blue">
                                            </Button>
                                            <Button x:Name="FF0000E0" Click="ChangeColorHEX" Width="20" Height="20" Style="{DynamicResource ColorButton}" Margin="5" Background="#FF0000E0">
                                            </Button>
                                            <Button x:Name="FF0000D0" Click="ChangeColorHEX" Width="20" Height="20" Style="{DynamicResource ColorButton}" Margin="5" Background="#FF0000D0">
                                            </Button>
                                            <Button x:Name="FF00009A" Click="ChangeColorHEX" Width="20" Height="20" Style="{DynamicResource ColorButton}" Margin="5" Background="#FF00009A">
                                            </Button>
                                        </StackPanel>
                                        <StackPanel Orientation="Vertical">
                                            <Button x:Name="Green" Click="ChangeColor" Width="20" Height="20" Style="{DynamicResource ColorButton}" Margin="5" Background="Green">
                                            </Button>
                                            <Button x:Name="FF009A00" Click="ChangeColorHEX" Width="20" Height="20" Style="{DynamicResource ColorButton}" Margin="5" Background="#FF009A00">
                                            </Button>
                                            <Button x:Name="FF00BF00" Click="ChangeColorHEX" Width="20" Height="20" Style="{DynamicResource ColorButton}" Margin="5" Background="#FF00BF00">
                                            </Button>
                                            <Button x:Name="FF00DC00" Click="ChangeColorHEX" Width="20" Height="20" Style="{DynamicResource ColorButton}" Margin="5" Background="#FF00DC00">
                                            </Button>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Border>
                    </Grid>
                </Border>
                <Border x:Name="Menu" Visibility="Hidden" Grid.Row="1" Margin="10" CornerRadius="15" Background="{DynamicResource OptionalBack}">
                    <Border.Effect>
                        <DropShadowEffect BlurRadius="10" ShadowDepth="0" Color="#FF929292"/>
                    </Border.Effect>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                            <ColumnDefinition Width="250"/>
                        </Grid.ColumnDefinitions>
                        <Border Background="{DynamicResource BackGround}" Margin="5" CornerRadius="15" Grid.Column="1">
                            <StackPanel Orientation="Vertical" VerticalAlignment="Center">
                                <Border Height="60" Margin="5" CornerRadius="10" Background="{DynamicResource BrandColor}">
                                    <StackPanel Orientation="Vertical" HorizontalAlignment="Center">
                                        <TextBlock Text="{DynamicResource settings.theme}" FontSize="16" Margin="5" HorizontalAlignment="Center" Foreground="White"></TextBlock>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                            <RadioButton x:Name="Dark" Margin="5" GroupName="Theme" Foreground="White" BorderBrush="#00060606" Background="{DynamicResource OptionalBack}" Checked="Dark_Checked">
                                                <TextBlock Text="{DynamicResource settings.theme.dark}"/>
                                            </RadioButton>
                                            <RadioButton x:Name="Light" Margin="5" GroupName="Theme" Foreground="White" BorderBrush="#00060606" Background="{DynamicResource OptionalBack}" Checked="Light_Checked">
                                                <TextBlock Text="{DynamicResource settings.theme.light}"/>
                                            </RadioButton>
                                            <Button ToolTip="{DynamicResource tm}" Style="{DynamicResource ButtonFlat}" Click="Button_Click_1" Margin="15,5,5,5">
                                                <Image Source="{StaticResource ThemeManager}" Width="20"/>
                                            </Button>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                                <Border Height="60" Margin="5" CornerRadius="10" Background="{DynamicResource BrandColor}">
                                    <StackPanel Orientation="Vertical" HorizontalAlignment="Center">
                                        <TextBlock Text="{DynamicResource settings.language}" FontSize="16" Margin="5" HorizontalAlignment="Center"  Foreground="White"></TextBlock>
                                        <ComboBox x:Name="Language" HorizontalAlignment="Center" Width="150" SelectionChanged="Language_SelectionChanged">
                                            <ComboBoxItem TabIndex="0" Content="Русский"/>
                                            <ComboBoxItem TabIndex="1" Content="English"/>
                                        </ComboBox>
                                    </StackPanel>
                                </Border>
                                <Border Height="60" Margin="5" CornerRadius="10" Background="{DynamicResource BrandColor}">
                                    <StackPanel Orientation="Vertical" HorizontalAlignment="Center">
                                        <TextBlock Text="{DynamicResource settings.spellcheck}" FontSize="16" Margin="5" HorizontalAlignment="Center"  Foreground="White"></TextBlock>
                                        <CheckBox x:Name="SpellCheck" HorizontalAlignment="Center" Unchecked="SpellCheck_Unchecked" Checked="SpellCheck_Checked">
                                            <TextBlock Text="{DynamicResource settings.spellchekc.enable}"/>
                                        </CheckBox>
                                    </StackPanel>
                                </Border>
                                <Button Click="Button_Click" Style="{StaticResource CornerButton}" Margin="5">
                                    <TextBlock Text="{DynamicResource te.open}" Margin="5"/>
                                </Button>
                                <Button x:Name="CheckUpdate" Click="CheckUpdate_Click" Style="{StaticResource CornerButton}" Margin="5">
                                    <TextBlock Text="{DynamicResource menu.checkupdate}" Margin="5"/>
                                </Button>
                            </StackPanel>
                        </Border>
                        <StackPanel Grid.Column="0" Orientation="Vertical" VerticalAlignment="Center">
                            <TextBlock Text="{DynamicResource title.welcome}" FontSize="20" HorizontalAlignment="Center" Margin="0,20,0,0"></TextBlock>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                <Border Width="250" Height="200" Margin="50">
                                    <ListBox Name="recentFilesListBox"
                                    HorizontalAlignment="Center" VerticalAlignment="Center"
                                    SelectionChanged="RecentFilesListBox_SelectionChanged"/>
                                </Border>
                                <StackPanel Orientation="Vertical" VerticalAlignment="Center">
                                    <Button Margin="5" Height="50" Style="{StaticResource CornerButton}" Background="{DynamicResource BrandColor}">
                                        <TextBlock Text="{DynamicResource menu.open}" Margin="5" FontSize="14"/>
                                    </Button>
                                    <Button Margin="5" Height="50" Style="{StaticResource CornerButton}" Background="{DynamicResource BrandColor}">
                                        <TextBlock Text="{DynamicResource menu.new}" Margin="5" FontSize="14"/>
                                    </Button>
                                    <Button Margin="5" Height="50" Style="{StaticResource CornerButton}" Background="{DynamicResource BrandColor}">
                                        <TextBlock Text="{DynamicResource menu.save}" Margin="5" FontSize="14"/>
                                    </Button>
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>
                        <TextBlock x:Name="versionTB" Margin="5" VerticalAlignment="Bottom" HorizontalAlignment="Center"/>
                    </Grid>
                </Border>
                <Border x:Name="UpdateMessage" Grid.RowSpan="2" Width="250" Visibility="Hidden" CornerRadius="15" VerticalAlignment="Top" HorizontalAlignment="Right" Margin="5" Background="#FFFFD051" >
                    <Border.Resources>
                        <Storyboard x:Key="BorderAnimation">
                            <!-- Анимация плавного появления (Opacity) -->
                            <DoubleAnimation Storyboard.TargetName="UpdateMessage" Storyboard.TargetProperty="Opacity" From="0" To="1" Duration="0:0:1" />

                            <!-- Анимация выдвижения из верхней части (Margin) -->
                            <ThicknessAnimation Storyboard.TargetName="UpdateMessage" Storyboard.TargetProperty="Margin" From="5,-100,5,5" To="5,5,5,5" Duration="0:0:1" />
                        </Storyboard>
                        <Storyboard x:Key="HideAnimation">
                            <DoubleAnimation Storyboard.TargetName="UpdateMessage" Storyboard.TargetProperty="Opacity" From="1" To="0" Duration="0:0:0.5" Completed="DoubleAnimation_Completed" />
                        </Storyboard>
                    </Border.Resources>
                    <Grid Margin="5">
                        <Button Style="{DynamicResource ButtonFlat}" Click="Button_Click_2" Content="✕" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="5"/>
                        <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Orientation="Vertical" Margin="0,25,0,0">
                            <TextBlock x:Name="UpdateStatusText" Text="Обновлений не найдено" FontSize="14" FontFamily="Comfortaa Light"/>
                            <Expander Header="Доп. инфо" IsExpanded="False" Background="#00FAFAFA">
                                <DataGrid x:Name="UpdateTable"  Background="#00FAFAFA" IsReadOnly="True" HorizontalScrollBarVisibility="Disabled">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="{DynamicResource us.remote}" Binding="{Binding RemoteValue}" Width="*"/>
                                        <DataGridTextColumn Header="{DynamicResource us.local}" Binding="{Binding LocalValue}" Width="*"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Expander>
                            <Button x:Name="InstallUpdate" Visibility="Collapsed" Click="InstallUpdate_Click" Style="{StaticResource CornerButton}" Background="#FFECB930" Margin="5">
                                <TextBlock Text="Установить обновления" Margin="5"/>
                            </Button>
                        </StackPanel>
                    </Grid>
                </Border>
            </Grid>
        </Border>
    </Grid>
</Window>
